@model NCAAFootballPlayoffs.Models.ViewModels.ResetPasswordViewModel

@{
    ViewBag.Title = "Reset Password";
}

<h2>Reset Password</h2>

@using (Html.BeginForm()) 
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(model => model.GeneratedKey)

    if (!ViewData.ModelState.IsValid)
    {
        <div class="form-group">
            <div class="col-sm-12">
                <div class="alert alert-danger">
                    @Html.ValidationSummary(false, "", new { @class = "text-danger" })
                </div>
            </div>
        </div>
    }

    <div class="form-horizontal">
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            <div>
                @Html.LabelFor(model => model.EmailAddress, htmlAttributes: new { @class = "control-label" })
            </div>
            <div>
                @Html.EditorFor(model => model.EmailAddress, new { htmlAttributes = new { @class = "form-control", @id = "emailAddressTextField" } })
            </div>
            <div>
                This button will send an email to the email provided above containing a key. Enter that key below along with your new password to change your password.
            </div>
            <div>
                @Html.ActionLink("Send Key", "SendKeyToEmail", "UserAccount", new { email = Model.EmailAddress, generatedKey = Model.GeneratedKey }, new { @class = "btn btn-primary", @id = "test" })
            </div>
        </div>
        <hr />
        <div class="form-group">
            <div>
                @Html.LabelFor(model => model.Password, htmlAttributes: new { @class = "control-label" })
            </div>
            <div>
                @Html.EditorFor(model => model.Password, new { htmlAttributes = new { @class = "form-control", @type = "password" } })
            </div>
        </div>
        <div class="form-group">
            <div>
                @Html.LabelFor(model => model.PasswordConfirm, htmlAttributes: new { @class = "control-label" })
            </div>
            <div>
                @Html.EditorFor(model => model.PasswordConfirm, new { htmlAttributes = new { @class = "form-control", @type = "password" } })
            </div>
        </div>

        <div class="form-group">
            <div>
                @Html.LabelFor(model => model.Key, htmlAttributes: new { @class = "control-label" })
            </div>
            <div>
                @Html.EditorFor(model => model.Key, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            <div>
                <input type="submit" value="Reset Password" class="btn btn-default" />
            </div>
        </div>
    </div>
}


<script>
    $('#test').click(function (e) {
        e.preventDefault();
        var email = $('#emailAddressTextField').val(); // get the textbox value
        var url = $(this).attr('href') + '&email=' + email; // build new url
        $.ajax({

            url: url, // comma here instead of semicolon
            success: function () {
                alert("Value Added");  // or any other indication if you want to show
            }

        });

        return false; // cancel default redirect
    });
</script>